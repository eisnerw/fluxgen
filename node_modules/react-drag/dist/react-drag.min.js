!function(t,e){"function"==typeof define&&define.amd?define(["React"],e):"object"==typeof exports?module.exports=e(require("React")):t.ReactDrag=e(t.React)}(this,function(t){"use strict";function e(t){return{position:{top:t.state.clientY,left:t.state.clientX}}}function n(t){return"both"===t.props.axis||"y"===t.props.axis}function s(t){return"both"===t.props.axis||"x"===t.props.axis}function o(t){return"function"==typeof t||"[object Function]"===Object.prototype.toString.call(t)}function r(t,e){for(var n=0,s=t.length,o=null;s>n;n+=1)if(o=t[n],e.apply(e,[o,n,t]))return o}function a(t,e){var n=r(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(e){return o(t[e])});return t[n].call(t,e)}function i(t){var e=t.touches&&t.touches[0]||t;return{clientX:e.clientX,clientY:e.clientY}}function h(t,e,n,s){if(n){"string"!=typeof n&&"parent"!==n.toLowerCase()&&"object"!=typeof n&&console.warn('Bound should either "parent" or an object');var o=s.parentNode,r=n.top||0,a=n.left||0,i=n.right||o.offsetWidth,h=n.bottom||o.offsetHeight;t=Math.min(t,i-s.offsetWidth),e=Math.min(e,h-s.offsetHeight),t=Math.max(a,t),e=Math.max(r,e)}return{clientX:t,clientY:e}}function c(t,e,n){t&&(t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener?t.addEventListener(e,n,!0):t["on"+e]=n)}function p(t,e,n){t&&(t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener?t.removeEventListener(e,n,!0):t["on"+e]=null)}var l=function(){},u=t.addons.classSet;if("undefined"==typeof window)var d=!1;else{var d="ontouchstart"in window||"onmsgesturechange"in window;try{document.createEvent("TouchEvent")}catch(f){d=!1}}var g=function(){var t={touch:{start:"touchstart",move:"touchmove",end:"touchend"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"}};return t[d?"touch":"mouse"]}(),v=t.createClass({displayName:"Draggable",propTypes:{axis:t.PropTypes.oneOf(["both","x","y"]),handle:t.PropTypes.string,cancel:t.PropTypes.string,grid:t.PropTypes.arrayOf(t.PropTypes.number),start:t.PropTypes.object,onStart:t.PropTypes.func,onDrag:t.PropTypes.func,onStop:t.PropTypes.func,onMouseDown:t.PropTypes.func,bound:t.PropTypes.any},componentWillUnmount:function(){p(window,g.move,this.handleDrag),p(window,g.end,this.handleDragEnd)},getDefaultProps:function(){return{axis:"both",handle:null,cancel:null,grid:null,bound:!1,start:{x:0,y:0},onStart:l,onDrag:l,onStop:l,onMouseDown:l}},getInitialState:function(){return{dragging:!1,startX:0,startY:0,offsetX:0,offsetY:0,clientX:this.props.start.x,clientY:this.props.start.y}},handleDragStart:function(t){this.props.onMouseDown(t);var n=this.getDOMNode();if(!(this.props.handle&&!a(t.target,this.props.handle)||this.props.cancel&&a(t.target,this.props.cancel))){var s=i(t);this.setState({dragging:!0,offsetX:parseInt(s.clientX,10),offsetY:parseInt(s.clientY,10),startX:parseInt(n.style.left,10)||0,startY:parseInt(n.style.top,10)||0}),this.props.onStart(t,e(this)),c(window,g.move,this.handleDrag),c(window,g.end,this.handleDragEnd)}},handleDragEnd:function(t){this.state.dragging&&(this.setState({dragging:!1}),this.props.onStop(t,e(this)),p(window,g.move,this.handleDrag),p(window,g.end,this.handleDragEnd))},handleDrag:function(t){var n=i(t),s=this.state.startX+(n.clientX-this.state.offsetX),o=this.state.startY+(n.clientY-this.state.offsetY),r=h(s,o,this.props.bound,this.getDOMNode());if(s=r.clientX,o=r.clientY,Array.isArray(this.props.grid)){var a=s<parseInt(this.state.clientX,10)?-1:1,c=o<parseInt(this.state.clientY,10)?-1:1;s=Math.abs(s-parseInt(this.state.clientX,10))>=this.props.grid[0]?parseInt(this.state.clientX,10)+this.props.grid[0]*a:this.state.clientX,o=Math.abs(o-parseInt(this.state.clientY,10))>=this.props.grid[1]?parseInt(this.state.clientY,10)+this.props.grid[1]*c:this.state.clientY}this.setState({clientX:s,clientY:o}),this.props.onDrag(t,e(this)),t.preventDefault()},render:function(){var e={top:n(this)?this.state.clientY:this.state.startY,left:s(this)?this.state.clientX:this.state.startX},o=u({"react-drag":!0,"react-drag-dragging":this.state.dragging});return t.addons.cloneWithProps(t.Children.only(this.props.children),{style:e,className:o,onMouseDown:this.handleDragStart,onTouchStart:function(t){return t.preventDefault(),this.handleDragStart.apply(this,arguments)}.bind(this),onMouseUp:this.handleDragEnd,onTouchEnd:this.handleDragEnd})}});return v});